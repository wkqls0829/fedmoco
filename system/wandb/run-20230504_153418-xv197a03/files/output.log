
wandb: WARNING Calling wandb.run.save without any arguments is deprecated.Changes to attributes are automatically persisted.
==================================================
Algorithm: FedCentral
Local batch size: 10
Local steps: 1
Local learing rate: 0.005
Total number of clients: 10
Clients join in each round: 1.0
Client drop rate: 0.0
Time select: False
Time threthold: 10000
Global rounds: 10
Running times: 1
Dataset: Cifar10
Local model: cnn
Using device: cuda
Cuda device id: 7
==================================================
============= Running time: 0th =============
Creating server and clients ...
FedAvgCNN(
  (conv1): Sequential(
    (0): Conv2d(3, 32, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (conv2): Sequential(
    (0): Conv2d(32, 64, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (fc1): Sequential(
    (0): Linear(in_features=1600, out_features=512, bias=True)
    (1): ReLU(inplace=True)
  )
  (fc): Linear(in_features=512, out_features=10, bias=True)
)
None
None
None
None
None
None
None
None
None
None
None
None
None
None
None
None
None
None
None
None
Join ratio / total clients: 1.0 / 10
Finished creating server and clients.
Cifar10_central
1
-------------Round number: 0-------------
Evaluate global model
[714.0, 707.0, 418.0, 398.0, 609.0, 577.0, 824.0, 779.0, 943.0, 948.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.7796
Averaged Test Accuracy: 0.4611
------------------------- time cost ------------------------- 15.744190692901611
-------------Round number: 1-------------
Evaluate global model
[921.0, 926.0, 702.0, 658.0, 598.0, 567.0, 960.0, 953.0, 996.0, 986.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.4366
Averaged Test Accuracy: 0.5511
------------------------- time cost ------------------------- 14.308288812637329
-------------Round number: 2-------------
Evaluate global model
[837.0, 866.0, 619.0, 586.0, 809.0, 774.0, 1105.0, 1115.0, 1179.0, 1187.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.3586
Averaged Test Accuracy: 0.6051
------------------------- time cost ------------------------- 13.758691787719727
-------------Round number: 3-------------
Evaluate global model
[969.0, 1006.0, 877.0, 830.0, 868.0, 863.0, 1004.0, 1049.0, 1153.0, 1170.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.3046
Averaged Test Accuracy: 0.6526
------------------------- time cost ------------------------- 14.5652494430542
-------------Round number: 4-------------
Evaluate global model
[1061.0, 1081.0, 781.0, 730.0, 1005.0, 1013.0, 1148.0, 1158.0, 1225.0, 1235.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.2658
Averaged Test Accuracy: 0.6958
------------------------- time cost ------------------------- 14.602473735809326
-------------Round number: 5-------------
Evaluate global model
[1187.0, 1211.0, 808.0, 774.0, 830.0, 834.0, 1218.0, 1223.0, 1205.0, 1227.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.2368
Averaged Test Accuracy: 0.7011
------------------------- time cost ------------------------- 14.25199842453003
-------------Round number: 6-------------
Evaluate global model
[1190.0, 1210.0, 796.0, 740.0, 1004.0, 1008.0, 1234.0, 1259.0, 1257.0, 1248.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.2162
Averaged Test Accuracy: 0.7297
------------------------- time cost ------------------------- 11.788002729415894
-------------Round number: 7-------------
Evaluate global model
[1204.0, 1210.0, 794.0, 767.0, 1171.0, 1175.0, 1193.0, 1235.0, 1286.0, 1308.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.1925
Averaged Test Accuracy: 0.7562
------------------------- time cost ------------------------- 10.986040830612183
-------------Round number: 8-------------
Evaluate global model
[1197.0, 1228.0, 1029.0, 988.0, 1123.0, 1113.0, 1247.0, 1263.0, 1317.0, 1328.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.1752
Averaged Test Accuracy: 0.7889
------------------------- time cost ------------------------- 11.044589519500732
-------------Round number: 9-------------
Evaluate global model
[1296.0, 1302.0, 1141.0, 1098.0, 1043.0, 1061.0, 1260.0, 1277.0, 1334.0, 1350.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.1583
Averaged Test Accuracy: 0.8108
------------------------- time cost ------------------------- 11.062398433685303
-------------Round number: 10-------------
Evaluate global model
[1357.0, 1363.0, 1018.0, 995.0, 1127.0, 1113.0, 1333.0, 1350.0, 1322.0, 1363.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.1443
Averaged Test Accuracy: 0.8227
------------------------- time cost ------------------------- 11.064178943634033
Best accuracy.
0.8227333333333333
Average time cost per round.
12.743191266059876
File path: ../results/Cifar10_FedCentral_nc=10_jr=1.0_90002.h5
Average time cost: 151.4s.
All done!
Storage on cuda:0
-------------------------------------------------------------------------------
Total Tensors: 29870292 	Used Memory: 77.11M
The allocated memory on cuda:0: 77.11M
-------------------------------------------------------------------------------
Storage on cpu
-------------------------------------------------------------------------------
Total Tensors: 737520000 	Used Memory: 1.37G
-------------------------------------------------------------------------------