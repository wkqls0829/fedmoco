
wandb: WARNING Calling wandb.run.save without any arguments is deprecated.Changes to attributes are automatically persisted.
==================================================
Algorithm: FedCentral
Local batch size: 10
Local steps: 1
Local learing rate: 0.005
Total number of clients: 10
Clients join in each round: 1.0
Client drop rate: 0.0
Time select: False
Time threthold: 10000
Global rounds: 20
Running times: 1
Dataset: Cifar10
Local model: cnn
Using device: cuda
Cuda device id: 7
==================================================
============= Running time: 0th =============
Creating server and clients ...
FedAvgCNN(
  (conv1): Sequential(
    (0): Conv2d(3, 32, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (conv2): Sequential(
    (0): Conv2d(32, 64, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (fc1): Sequential(
    (0): Linear(in_features=1600, out_features=512, bias=True)
    (1): ReLU(inplace=True)
  )
  (fc): Linear(in_features=512, out_features=10, bias=True)
)
None
None
None
None
None
None
None
None
None
None
None
None
None
None
None
None
None
None
None
None
Join ratio / total clients: 1.0 / 10
Finished creating server and clients.
Cifar10_central
1
-------------Round number: 0-------------
Evaluate global model
[0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 501.0, 520.0, 217.0, 213.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 10.0000
Averaged Test Accuracy: 0.0968
-------------Round number: 0-------------
Evaluate global model
[714.0, 690.0, 620.0, 582.0, 542.0, 504.0, 822.0, 773.0, 885.0, 885.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.7807
Averaged Test Accuracy: 0.4678
------------------------- time cost ------------------------- 19.75606942176819
-------------Round number: 1-------------
Evaluate global model
[714.0, 690.0, 620.0, 582.0, 542.0, 504.0, 822.0, 773.0, 885.0, 885.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.7807
Averaged Test Accuracy: 0.4678
-------------Round number: 1-------------
Evaluate global model
[861.0, 876.0, 605.0, 553.0, 655.0, 601.0, 946.0, 952.0, 1054.0, 1095.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.4373
Averaged Test Accuracy: 0.5465
------------------------- time cost ------------------------- 18.265803575515747
-------------Round number: 2-------------
Evaluate global model
[861.0, 876.0, 605.0, 553.0, 655.0, 601.0, 946.0, 952.0, 1054.0, 1095.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.4373
Averaged Test Accuracy: 0.5465
-------------Round number: 2-------------
Evaluate global model
[1019.0, 1027.0, 697.0, 652.0, 857.0, 847.0, 937.0, 943.0, 1122.0, 1154.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.3598
Averaged Test Accuracy: 0.6170
------------------------- time cost ------------------------- 18.3317232131958
-------------Round number: 3-------------
Evaluate global model
[1019.0, 1027.0, 697.0, 652.0, 857.0, 847.0, 937.0, 943.0, 1122.0, 1154.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.3598
Averaged Test Accuracy: 0.6170
-------------Round number: 3-------------
Evaluate global model
[1147.0, 1181.0, 768.0, 740.0, 789.0, 799.0, 1057.0, 1062.0, 983.0, 1014.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.3027
Averaged Test Accuracy: 0.6360
------------------------- time cost ------------------------- 18.4033842086792
-------------Round number: 4-------------
Evaluate global model
[1147.0, 1181.0, 768.0, 740.0, 789.0, 799.0, 1057.0, 1062.0, 983.0, 1014.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.3027
Averaged Test Accuracy: 0.6360
-------------Round number: 4-------------
Evaluate global model
[1134.0, 1168.0, 998.0, 983.0, 659.0, 637.0, 1003.0, 1011.0, 1210.0, 1238.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.2662
Averaged Test Accuracy: 0.6694
------------------------- time cost ------------------------- 18.66848134994507
-------------Round number: 5-------------
Evaluate global model
[1134.0, 1168.0, 998.0, 983.0, 659.0, 637.0, 1003.0, 1011.0, 1210.0, 1238.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.2662
Averaged Test Accuracy: 0.6694
-------------Round number: 5-------------
Evaluate global model
[1137.0, 1167.0, 850.0, 823.0, 1033.0, 1055.0, 1134.0, 1134.0, 1255.0, 1284.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.2374
Averaged Test Accuracy: 0.7248
------------------------- time cost ------------------------- 18.40862274169922
-------------Round number: 6-------------
Evaluate global model
[1137.0, 1167.0, 850.0, 823.0, 1033.0, 1055.0, 1134.0, 1134.0, 1255.0, 1284.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.2374
Averaged Test Accuracy: 0.7248
-------------Round number: 6-------------
Evaluate global model
[1170.0, 1186.0, 1080.0, 1040.0, 817.0, 824.0, 1193.0, 1216.0, 1252.0, 1266.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.2145
Averaged Test Accuracy: 0.7363
------------------------- time cost ------------------------- 18.602609872817993
-------------Round number: 7-------------
Evaluate global model
[1170.0, 1186.0, 1080.0, 1040.0, 817.0, 824.0, 1193.0, 1216.0, 1252.0, 1266.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.2145
Averaged Test Accuracy: 0.7363
-------------Round number: 7-------------
Evaluate global model
[1247.0, 1229.0, 1074.0, 1018.0, 891.0, 887.0, 1232.0, 1242.0, 1264.0, 1303.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.1939
Averaged Test Accuracy: 0.7591
------------------------- time cost ------------------------- 18.528205394744873
-------------Round number: 8-------------
Evaluate global model
[1247.0, 1229.0, 1074.0, 1018.0, 891.0, 887.0, 1232.0, 1242.0, 1264.0, 1303.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.1939
Averaged Test Accuracy: 0.7591
-------------Round number: 8-------------
Evaluate global model
[1323.0, 1342.0, 1057.0, 995.0, 1060.0, 1063.0, 1222.0, 1253.0, 1213.0, 1250.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.1734
Averaged Test Accuracy: 0.7852
------------------------- time cost ------------------------- 18.45851230621338
-------------Round number: 9-------------
Evaluate global model
[1323.0, 1342.0, 1057.0, 995.0, 1060.0, 1063.0, 1222.0, 1253.0, 1213.0, 1250.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.1734
Averaged Test Accuracy: 0.7852
-------------Round number: 9-------------
Evaluate global model
[1301.0, 1314.0, 891.0, 836.0, 1258.0, 1261.0, 1242.0, 1270.0, 1252.0, 1278.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.1587
Averaged Test Accuracy: 0.7935
------------------------- time cost ------------------------- 18.28213882446289
-------------Round number: 10-------------
Evaluate global model
[1301.0, 1314.0, 891.0, 836.0, 1258.0, 1261.0, 1242.0, 1270.0, 1252.0, 1278.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.1587
Averaged Test Accuracy: 0.7935
-------------Round number: 10-------------
Evaluate global model
[1414.0, 1407.0, 1085.0, 1054.0, 1051.0, 1053.0, 1263.0, 1283.0, 1241.0, 1277.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.1434
Averaged Test Accuracy: 0.8085
------------------------- time cost ------------------------- 17.604684829711914
-------------Round number: 11-------------
Evaluate global model
[1414.0, 1407.0, 1085.0, 1054.0, 1051.0, 1053.0, 1263.0, 1283.0, 1241.0, 1277.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.1434
Averaged Test Accuracy: 0.8085
-------------Round number: 11-------------
Evaluate global model
[1332.0, 1338.0, 1063.0, 1043.0, 1213.0, 1202.0, 1213.0, 1251.0, 1360.0, 1382.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.1322
Averaged Test Accuracy: 0.8265
------------------------- time cost ------------------------- 15.075000524520874
-------------Round number: 12-------------
Evaluate global model
[1332.0, 1338.0, 1063.0, 1043.0, 1213.0, 1202.0, 1213.0, 1251.0, 1360.0, 1382.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.1322
Averaged Test Accuracy: 0.8265
-------------Round number: 12-------------
Evaluate global model
[1394.0, 1388.0, 1156.0, 1146.0, 1253.0, 1275.0, 1319.0, 1315.0, 1364.0, 1391.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.1207
Averaged Test Accuracy: 0.8667
------------------------- time cost ------------------------- 14.964509963989258
-------------Round number: 13-------------
Evaluate global model
[1394.0, 1388.0, 1156.0, 1146.0, 1253.0, 1275.0, 1319.0, 1315.0, 1364.0, 1391.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.1207
Averaged Test Accuracy: 0.8667
-------------Round number: 13-------------
Evaluate global model
[1388.0, 1374.0, 1242.0, 1188.0, 1248.0, 1272.0, 1324.0, 1320.0, 1380.0, 1402.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.1122
Averaged Test Accuracy: 0.8759
------------------------- time cost ------------------------- 15.221425771713257
-------------Round number: 14-------------
Evaluate global model
[1388.0, 1374.0, 1242.0, 1188.0, 1248.0, 1272.0, 1324.0, 1320.0, 1380.0, 1402.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.1122
Averaged Test Accuracy: 0.8759
-------------Round number: 14-------------
Evaluate global model
[1341.0, 1350.0, 1230.0, 1203.0, 1340.0, 1362.0, 1310.0, 1289.0, 1405.0, 1421.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.1066
Averaged Test Accuracy: 0.8834
------------------------- time cost ------------------------- 14.90242075920105
-------------Round number: 15-------------
Evaluate global model
[1341.0, 1350.0, 1230.0, 1203.0, 1340.0, 1362.0, 1310.0, 1289.0, 1405.0, 1421.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.1066
Averaged Test Accuracy: 0.8834
-------------Round number: 15-------------
Evaluate global model
[1370.0, 1383.0, 1203.0, 1200.0, 1268.0, 1298.0, 1400.0, 1404.0, 1409.0, 1420.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.1027
Averaged Test Accuracy: 0.8903
------------------------- time cost ------------------------- 15.108418464660645
-------------Round number: 16-------------
Evaluate global model
[1370.0, 1383.0, 1203.0, 1200.0, 1268.0, 1298.0, 1400.0, 1404.0, 1409.0, 1420.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.1027
Averaged Test Accuracy: 0.8903
-------------Round number: 16-------------
Evaluate global model
[1379.0, 1389.0, 1261.0, 1265.0, 1351.0, 1392.0, 1397.0, 1392.0, 1412.0, 1425.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.1040
Averaged Test Accuracy: 0.9109
------------------------- time cost ------------------------- 15.156732082366943
-------------Round number: 17-------------
Evaluate global model
[1379.0, 1389.0, 1261.0, 1265.0, 1351.0, 1392.0, 1397.0, 1392.0, 1412.0, 1425.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.1040
Averaged Test Accuracy: 0.9109
-------------Round number: 17-------------
Evaluate global model
[1393.0, 1411.0, 1338.0, 1332.0, 1301.0, 1333.0, 1395.0, 1399.0, 1403.0, 1414.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.1058
Averaged Test Accuracy: 0.9146
------------------------- time cost ------------------------- 15.025570392608643
-------------Round number: 18-------------
Evaluate global model
[1393.0, 1411.0, 1338.0, 1332.0, 1301.0, 1333.0, 1395.0, 1399.0, 1403.0, 1414.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.1058
Averaged Test Accuracy: 0.9146
-------------Round number: 18-------------
Evaluate global model
[1384.0, 1402.0, 1261.0, 1248.0, 1313.0, 1343.0, 1431.0, 1427.0, 1423.0, 1434.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.1158
Averaged Test Accuracy: 0.9111
------------------------- time cost ------------------------- 15.176185369491577
-------------Round number: 19-------------
Evaluate global model
[1384.0, 1402.0, 1261.0, 1248.0, 1313.0, 1343.0, 1431.0, 1427.0, 1423.0, 1434.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.1158
Averaged Test Accuracy: 0.9111
-------------Round number: 19-------------
Evaluate global model
[1430.0, 1432.0, 1296.0, 1280.0, 1361.0, 1376.0, 1416.0, 1424.0, 1405.0, 1427.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.1202
Averaged Test Accuracy: 0.9231
------------------------- time cost ------------------------- 15.12329912185669
-------------Round number: 20-------------
Evaluate global model
[1430.0, 1432.0, 1296.0, 1280.0, 1361.0, 1376.0, 1416.0, 1424.0, 1405.0, 1427.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.1202
Averaged Test Accuracy: 0.9231
-------------Round number: 20-------------
Evaluate global model
[1419.0, 1438.0, 1329.0, 1299.0, 1370.0, 1410.0, 1422.0, 1423.0, 1411.0, 1428.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.1358
Averaged Test Accuracy: 0.9299
------------------------- time cost ------------------------- 15.072307825088501
Best accuracy.
0.9299333333333333
Average time cost per round.
16.719001829624176
File path: ../results/Cifar10_FedCentral_nc=10_jr=1.0_90002.h5
Average time cost: 361.94s.
All done!
Storage on cuda:0
-------------------------------------------------------------------------------
Total Tensors: 29870292 	Used Memory: 77.11M
The allocated memory on cuda:0: 77.11M
-------------------------------------------------------------------------------
Storage on cpu
-------------------------------------------------------------------------------
Total Tensors: 737520000 	Used Memory: 1.37G
-------------------------------------------------------------------------------