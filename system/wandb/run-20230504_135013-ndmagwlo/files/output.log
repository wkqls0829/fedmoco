
wandb: WARNING Calling wandb.run.save without any arguments is deprecated.Changes to attributes are automatically persisted.
==================================================
Algorithm: FedMGDA
Local batch size: 10
Local steps: 1
Local learing rate: 0.005
Total number of clients: 1
Clients join in each round: 1.0
Client drop rate: 0.0
Time select: False
Time threthold: 10000
Global rounds: 20
Running times: 1
Dataset: Cifar10
Local model: cnn
Using device: cuda
Cuda device id: 7
==================================================
============= Running time: 0th =============
Creating server and clients ...
FedAvgCNN(
  (conv1): Sequential(
    (0): Conv2d(3, 32, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (conv2): Sequential(
    (0): Conv2d(32, 64, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (fc1): Sequential(
    (0): Linear(in_features=1600, out_features=512, bias=True)
    (1): ReLU(inplace=True)
  )
  (fc): Linear(in_features=512, out_features=10, bias=True)
)
Cifar10_central
Cifar10_central
Join ratio / total clients: 1.0 / 1
Finished creating server and clients.
-------------Round number: 0-------------
Evaluate global model
Averaged Train Loss: 1.7896
Averaged Test Accuracy: 0.4574
------------------------- time cost ------------------------- 10.660978078842163
-------------Round number: 1-------------
Evaluate global model
Averaged Train Loss: 1.3935
Averaged Test Accuracy: 0.5151
------------------------- time cost ------------------------- 9.74422287940979
-------------Round number: 2-------------
Evaluate global model
Averaged Train Loss: 1.2153
Averaged Test Accuracy: 0.5920
------------------------- time cost ------------------------- 10.115104913711548
-------------Round number: 3-------------
Evaluate global model
Averaged Train Loss: 1.0711
Averaged Test Accuracy: 0.6234
------------------------- time cost ------------------------- 9.34234356880188
-------------Round number: 4-------------
Evaluate global model
Averaged Train Loss: 0.9650
Averaged Test Accuracy: 0.6561
------------------------- time cost ------------------------- 10.365728855133057
-------------Round number: 5-------------
Evaluate global model
Averaged Train Loss: 0.8766
Averaged Test Accuracy: 0.6761
------------------------- time cost ------------------------- 9.64485216140747
-------------Round number: 6-------------
Evaluate global model
Averaged Train Loss: 0.7942
Averaged Test Accuracy: 0.6873
------------------------- time cost ------------------------- 9.968589067459106
-------------Round number: 7-------------
Evaluate global model
Averaged Train Loss: 0.7194
Averaged Test Accuracy: 0.7001
------------------------- time cost ------------------------- 9.972184658050537
-------------Round number: 8-------------
Evaluate global model
Averaged Train Loss: 0.6496
Averaged Test Accuracy: 0.7149
------------------------- time cost ------------------------- 9.620020389556885
-------------Round number: 9-------------
Evaluate global model
Averaged Train Loss: 0.5822
Averaged Test Accuracy: 0.7090
------------------------- time cost ------------------------- 10.240512371063232
-------------Round number: 10-------------
Evaluate global model
Averaged Train Loss: 0.5163
Averaged Test Accuracy: 0.7253
------------------------- time cost ------------------------- 9.385746955871582
-------------Round number: 11-------------
Evaluate global model
Averaged Train Loss: 0.4490
Averaged Test Accuracy: 0.7201
------------------------- time cost ------------------------- 10.332866191864014
-------------Round number: 12-------------
Evaluate global model
Averaged Train Loss: 0.3862
Averaged Test Accuracy: 0.7334
------------------------- time cost ------------------------- 9.674600839614868
-------------Round number: 13-------------
Evaluate global model
Averaged Train Loss: 0.3226
Averaged Test Accuracy: 0.7227
------------------------- time cost ------------------------- 10.166595935821533
-------------Round number: 14-------------
Evaluate global model
Averaged Train Loss: 0.2610
Averaged Test Accuracy: 0.7228
------------------------- time cost ------------------------- 9.920817375183105
-------------Round number: 15-------------
Evaluate global model
Averaged Train Loss: 0.2070
Averaged Test Accuracy: 0.7247
------------------------- time cost ------------------------- 9.370422124862671
-------------Round number: 16-------------
Evaluate global model
Averaged Train Loss: 0.1604
Averaged Test Accuracy: 0.7219
------------------------- time cost ------------------------- 10.192680358886719
-------------Round number: 17-------------
Evaluate global model
Averaged Train Loss: 0.1174
Averaged Test Accuracy: 0.7276
------------------------- time cost ------------------------- 9.352514505386353
-------------Round number: 18-------------
Evaluate global model
Averaged Train Loss: 0.0824
Averaged Test Accuracy: 0.7323
------------------------- time cost ------------------------- 10.114112138748169
-------------Round number: 19-------------
Evaluate global model
Averaged Train Loss: 0.0526
Averaged Test Accuracy: 0.7359
------------------------- time cost ------------------------- 9.310746431350708
-------------Round number: 20-------------
Evaluate global model
Averaged Train Loss: 0.0341
Averaged Test Accuracy: 0.7337
------------------------- time cost ------------------------- 10.035115718841553
Best accuracy.
0.7358666666666667
Average time cost per round.
9.843488872051239
File path: ../results/Cifar10_FedMGDA_nc=1_jr=1.0_90001.h5
Average time cost: 213.67s.
All done!
Storage on cuda:0
-------------------------------------------------------------------------------
Total Tensors: 4392690 	Used Memory: 13.41M
The allocated memory on cuda:0: 13.41M
-------------------------------------------------------------------------------
Storage on cpu
-------------------------------------------------------------------------------
Total Tensors: 368760000 	Used Memory: 703.58M
-------------------------------------------------------------------------------