
wandb: WARNING Calling wandb.run.save without any arguments is deprecated.Changes to attributes are automatically persisted.
==================================================
Algorithm: FedCentral
Local batch size: 10
Local steps: 1
Local learing rate: 0.005
Total number of clients: 10
Clients join in each round: 1.0
Client drop rate: 0.0
Time select: False
Time threthold: 10000
Global rounds: 10
Running times: 1
Dataset: Cifar10
Local model: cnn
Using device: cuda
Cuda device id: 7
==================================================
============= Running time: 0th =============
Creating server and clients ...
FedAvgCNN(
  (conv1): Sequential(
    (0): Conv2d(3, 32, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (conv2): Sequential(
    (0): Conv2d(32, 64, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (fc1): Sequential(
    (0): Linear(in_features=1600, out_features=512, bias=True)
    (1): ReLU(inplace=True)
  )
  (fc): Linear(in_features=512, out_features=10, bias=True)
)
None
None
None
None
None
None
None
None
None
None
None
None
None
None
None
None
None
None
None
None
Join ratio / total clients: 1.0 / 10
Finished creating server and clients.
Cifar10_central
1
-------------Round number: 0-------------
Evaluate global model
[725.0, 710.0, 423.0, 396.0, 609.0, 574.0, 823.0, 780.0, 943.0, 947.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.7825
Averaged Test Accuracy: 0.4620
------------------------- time cost ------------------------- 19.805996894836426
-------------Round number: 1-------------
Evaluate global model
[915.0, 918.0, 699.0, 657.0, 600.0, 565.0, 961.0, 956.0, 996.0, 990.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.4368
Averaged Test Accuracy: 0.5505
------------------------- time cost ------------------------- 17.733378410339355
-------------Round number: 2-------------
Evaluate global model
[836.0, 870.0, 625.0, 585.0, 804.0, 773.0, 1105.0, 1116.0, 1183.0, 1187.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.3614
Averaged Test Accuracy: 0.6056
------------------------- time cost ------------------------- 17.854691743850708
-------------Round number: 3-------------
Evaluate global model
[971.0, 990.0, 879.0, 844.0, 864.0, 854.0, 999.0, 1054.0, 1154.0, 1176.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.3059
Averaged Test Accuracy: 0.6523
------------------------- time cost ------------------------- 17.751955270767212
-------------Round number: 4-------------
Evaluate global model
[1075.0, 1078.0, 777.0, 718.0, 992.0, 1003.0, 1166.0, 1151.0, 1220.0, 1235.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.2671
Averaged Test Accuracy: 0.6943
------------------------- time cost ------------------------- 17.765217781066895
-------------Round number: 5-------------
Evaluate global model
[1184.0, 1204.0, 815.0, 773.0, 826.0, 832.0, 1210.0, 1219.0, 1205.0, 1240.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.2376
Averaged Test Accuracy: 0.7005
------------------------- time cost ------------------------- 17.748027324676514
-------------Round number: 6-------------
Evaluate global model
[1194.0, 1222.0, 800.0, 736.0, 1015.0, 1022.0, 1235.0, 1266.0, 1249.0, 1236.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.2154
Averaged Test Accuracy: 0.7317
------------------------- time cost ------------------------- 14.588825464248657
-------------Round number: 7-------------
Evaluate global model
[1186.0, 1201.0, 807.0, 766.0, 1181.0, 1172.0, 1195.0, 1228.0, 1290.0, 1304.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.1936
Averaged Test Accuracy: 0.7553
------------------------- time cost ------------------------- 14.63331937789917
-------------Round number: 8-------------
Evaluate global model
[1181.0, 1212.0, 1023.0, 978.0, 1088.0, 1097.0, 1245.0, 1246.0, 1320.0, 1339.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.1751
Averaged Test Accuracy: 0.7819
------------------------- time cost ------------------------- 14.532793521881104
-------------Round number: 9-------------
Evaluate global model
[1304.0, 1297.0, 1135.0, 1106.0, 1026.0, 1028.0, 1263.0, 1273.0, 1340.0, 1355.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.1587
Averaged Test Accuracy: 0.8085
------------------------- time cost ------------------------- 14.688156127929688
-------------Round number: 10-------------
Evaluate global model
[1360.0, 1364.0, 1021.0, 987.0, 1110.0, 1095.0, 1339.0, 1348.0, 1327.0, 1359.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.1452
Averaged Test Accuracy: 0.8207
------------------------- time cost ------------------------- 14.515510559082031
Best accuracy.
0.8206666666666667
Average time cost per round.
16.181187558174134
File path: ../results/Cifar10_FedCentral_nc=10_jr=1.0_90002.h5
Average time cost: 189.89s.
All done!
Storage on cuda:0
-------------------------------------------------------------------------------
Total Tensors: 29870292 	Used Memory: 77.11M
The allocated memory on cuda:0: 77.11M
-------------------------------------------------------------------------------
Storage on cpu
-------------------------------------------------------------------------------
Total Tensors: 737520000 	Used Memory: 1.37G
-------------------------------------------------------------------------------