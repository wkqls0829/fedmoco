==================================================
Algorithm: FedCentral
Local batch size: 10
Local steps: 1
Local learing rate: 0.005
Total number of clients: 10
Clients join in each round: 1.0
Client drop rate: 0.0
Time select: False
Time threthold: 10000
Global rounds: 10
Running times: 1
Dataset: Cifar10
Local model: cnn
Using device: cuda
Cuda device id: 7
==================================================
============= Running time: 0th =============
Creating server and clients ...
FedAvgCNN(
  (conv1): Sequential(
    (0): Conv2d(3, 32, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (conv2): Sequential(
    (0): Conv2d(32, 64, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (fc1): Sequential(
    (0): Linear(in_features=1600, out_features=512, bias=True)
    (1): ReLU(inplace=True)
  )
  (fc): Linear(in_features=512, out_features=10, bias=True)
)
None
None
wandb: WARNING Calling wandb.run.save without any arguments is deprecated.Changes to attributes are automatically persisted.
None
None
None
None
None
None
None
None
None
None
None
None
None
None
None
None
None
None
Join ratio / total clients: 1.0 / 10
Finished creating server and clients.
Cifar10_central
1
-------------Round number: 0-------------
Evaluate global model
[714.0, 708.0, 425.0, 401.0, 611.0, 574.0, 822.0, 775.0, 946.0, 946.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.7806
Averaged Test Accuracy: 0.4615
------------------------- time cost ------------------------- 17.4222309589386
-------------Round number: 1-------------
Evaluate global model
[914.0, 917.0, 696.0, 661.0, 601.0, 563.0, 962.0, 960.0, 993.0, 987.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.4376
Averaged Test Accuracy: 0.5503
------------------------- time cost ------------------------- 15.011477947235107
-------------Round number: 2-------------
Evaluate global model
[839.0, 866.0, 609.0, 584.0, 810.0, 781.0, 1101.0, 1112.0, 1183.0, 1189.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.3597
Averaged Test Accuracy: 0.6049
------------------------- time cost ------------------------- 14.803093194961548
-------------Round number: 3-------------
Evaluate global model
[962.0, 990.0, 878.0, 846.0, 860.0, 850.0, 1015.0, 1049.0, 1163.0, 1176.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.3041
Averaged Test Accuracy: 0.6526
------------------------- time cost ------------------------- 14.740291357040405
-------------Round number: 4-------------
Evaluate global model
[1058.0, 1078.0, 775.0, 722.0, 997.0, 1005.0, 1161.0, 1147.0, 1226.0, 1234.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.2672
Averaged Test Accuracy: 0.6935
------------------------- time cost ------------------------- 14.870996952056885
-------------Round number: 5-------------
Evaluate global model
[1192.0, 1205.0, 803.0, 779.0, 828.0, 825.0, 1213.0, 1227.0, 1209.0, 1230.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.2373
Averaged Test Accuracy: 0.7007
------------------------- time cost ------------------------- 21.147313356399536
-------------Round number: 6-------------
Evaluate global model
[1194.0, 1222.0, 829.0, 757.0, 1000.0, 1010.0, 1235.0, 1259.0, 1250.0, 1233.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.2144
Averaged Test Accuracy: 0.7326
------------------------- time cost ------------------------- 17.615769147872925
-------------Round number: 7-------------
Evaluate global model
[1198.0, 1208.0, 808.0, 778.0, 1183.0, 1182.0, 1193.0, 1226.0, 1279.0, 1300.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.1931
Averaged Test Accuracy: 0.7570
------------------------- time cost ------------------------- 16.561521530151367
-------------Round number: 8-------------
Evaluate global model
[1188.0, 1228.0, 1041.0, 1002.0, 1092.0, 1073.0, 1249.0, 1244.0, 1319.0, 1333.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.1743
Averaged Test Accuracy: 0.7846
------------------------- time cost ------------------------- 12.317922592163086
-------------Round number: 9-------------
Evaluate global model
[1288.0, 1298.0, 1125.0, 1096.0, 1028.0, 1041.0, 1261.0, 1283.0, 1340.0, 1359.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.1582
Averaged Test Accuracy: 0.8079
------------------------- time cost ------------------------- 11.653878450393677
-------------Round number: 10-------------
Evaluate global model
[1354.0, 1358.0, 991.0, 970.0, 1110.0, 1086.0, 1352.0, 1359.0, 1338.0, 1359.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.1429
Averaged Test Accuracy: 0.8185
------------------------- time cost ------------------------- 11.586087703704834
Best accuracy.
0.8184666666666667
Average time cost per round.
15.030835223197936
File path: ../results/Cifar10_FedCentral_nc=10_jr=1.0_90002.h5
Average time cost: 176.05s.
All done!
Storage on cuda:0
-------------------------------------------------------------------------------
Total Tensors: 29870292 	Used Memory: 77.11M
The allocated memory on cuda:0: 77.11M
-------------------------------------------------------------------------------
Storage on cpu
-------------------------------------------------------------------------------
Total Tensors: 737520000 	Used Memory: 1.37G
-------------------------------------------------------------------------------