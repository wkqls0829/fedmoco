
wandb: WARNING Calling wandb.run.save without any arguments is deprecated.Changes to attributes are automatically persisted.
==================================================
Algorithm: FedMGDA
Local batch size: 10
Local steps: 1
Local learing rate: 0.005
Total number of clients: 1
Clients join in each round: 1.0
Client drop rate: 0.0
Time select: False
Time threthold: 10000
Global rounds: 10
Running times: 1
Dataset: Cifar10
Local model: cnn
Using device: cuda
Cuda device id: 7
==================================================
============= Running time: 0th =============
Creating server and clients ...
FedAvgCNN(
  (conv1): Sequential(
    (0): Conv2d(3, 32, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (conv2): Sequential(
    (0): Conv2d(32, 64, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (fc1): Sequential(
    (0): Linear(in_features=1600, out_features=512, bias=True)
    (1): ReLU(inplace=True)
  )
  (fc): Linear(in_features=512, out_features=10, bias=True)
)
Cifar10_central
Cifar10_central
Join ratio / total clients: 1.0 / 1
Finished creating server and clients.
-------------Round number: 0-------------
Evaluate global model
[6864.0]
[15000]
Averaged Train Loss: 1.7894
Averaged Test Accuracy: 0.4576
------------------------- time cost ------------------------- 9.564871311187744
-------------Round number: 1-------------
Evaluate global model
[7737.0]
[15000]
Averaged Train Loss: 1.3936
Averaged Test Accuracy: 0.5158
------------------------- time cost ------------------------- 8.446064233779907
-------------Round number: 2-------------
Evaluate global model
[8853.0]
[15000]
Averaged Train Loss: 1.2159
Averaged Test Accuracy: 0.5902
------------------------- time cost ------------------------- 8.395613193511963
-------------Round number: 3-------------
Evaluate global model
[9317.0]
[15000]
Averaged Train Loss: 1.0722
Averaged Test Accuracy: 0.6211
------------------------- time cost ------------------------- 8.04805064201355
-------------Round number: 4-------------
Evaluate global model
[9864.0]
[15000]
Averaged Train Loss: 0.9663
Averaged Test Accuracy: 0.6576
------------------------- time cost ------------------------- 9.016988515853882
-------------Round number: 5-------------
Evaluate global model
[10111.0]
[15000]
Averaged Train Loss: 0.8773
Averaged Test Accuracy: 0.6741
------------------------- time cost ------------------------- 7.94250750541687
-------------Round number: 6-------------
Evaluate global model
[10325.0]
[15000]
Averaged Train Loss: 0.7960
Averaged Test Accuracy: 0.6883
------------------------- time cost ------------------------- 8.43087387084961
-------------Round number: 7-------------
Evaluate global model
[10512.0]
[15000]
Averaged Train Loss: 0.7210
Averaged Test Accuracy: 0.7008
------------------------- time cost ------------------------- 8.225204229354858
-------------Round number: 8-------------
Evaluate global model
[10732.0]
[15000]
Averaged Train Loss: 0.6503
Averaged Test Accuracy: 0.7155
------------------------- time cost ------------------------- 8.082924365997314
-------------Round number: 9-------------
Evaluate global model
[10654.0]
[15000]
Averaged Train Loss: 0.5828
Averaged Test Accuracy: 0.7103
------------------------- time cost ------------------------- 8.370861530303955
-------------Round number: 10-------------
Evaluate global model
[10877.0]
[15000]
Averaged Train Loss: 0.5164
Averaged Test Accuracy: 0.7251
------------------------- time cost ------------------------- 8.103395223617554
Best accuracy.
0.7251333333333333
Average time cost per round.
8.306248331069947
File path: ../results/Cifar10_FedMGDA_nc=1_jr=1.0_90001.h5
Average time cost: 98.7s.
All done!
Storage on cuda:0
-------------------------------------------------------------------------------
Total Tensors: 4392690 	Used Memory: 13.41M
The allocated memory on cuda:0: 13.41M
-------------------------------------------------------------------------------
Storage on cpu
-------------------------------------------------------------------------------
Total Tensors: 368760000 	Used Memory: 703.58M
-------------------------------------------------------------------------------