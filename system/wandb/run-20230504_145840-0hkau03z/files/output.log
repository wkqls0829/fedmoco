
wandb: WARNING Calling wandb.run.save without any arguments is deprecated.Changes to attributes are automatically persisted.
==================================================
Algorithm: FedCentral
Local batch size: 10
Local steps: 1
Local learing rate: 0.005
Total number of clients: 10
Clients join in each round: 1.0
Client drop rate: 0.0
Time select: False
Time threthold: 10000
Global rounds: 10
Running times: 1
Dataset: Cifar10
Local model: cnn
Using device: cuda
Cuda device id: 7
==================================================
============= Running time: 0th =============
Creating server and clients ...
FedAvgCNN(
  (conv1): Sequential(
    (0): Conv2d(3, 32, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (conv2): Sequential(
    (0): Conv2d(32, 64, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (fc1): Sequential(
    (0): Linear(in_features=1600, out_features=512, bias=True)
    (1): ReLU(inplace=True)
  )
  (fc): Linear(in_features=512, out_features=10, bias=True)
)
None
None
None
None
None
None
None
None
None
None
None
None
None
None
None
None
None
None
None
None
Join ratio / total clients: 1.0 / 10
Finished creating server and clients.
Cifar10_central
1
-------------Round number: 0-------------
Evaluate global model
[0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 501.0, 520.0, 217.0, 213.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 10.0000
Averaged Test Accuracy: 0.0968
-------------Round number: 0-------------
Evaluate global model
[715.0, 692.0, 623.0, 580.0, 546.0, 502.0, 821.0, 773.0, 891.0, 885.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.7793
Averaged Test Accuracy: 0.4685
------------------------- time cost ------------------------- 22.141528844833374
-------------Round number: 1-------------
Evaluate global model
[715.0, 692.0, 623.0, 580.0, 546.0, 502.0, 821.0, 773.0, 891.0, 885.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.7793
Averaged Test Accuracy: 0.4685
-------------Round number: 1-------------
Evaluate global model
[860.0, 874.0, 595.0, 552.0, 654.0, 606.0, 946.0, 953.0, 1052.0, 1089.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.4357
Averaged Test Accuracy: 0.5454
------------------------- time cost ------------------------- 21.11512517929077
-------------Round number: 2-------------
Evaluate global model
[860.0, 874.0, 595.0, 552.0, 654.0, 606.0, 946.0, 953.0, 1052.0, 1089.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.4357
Averaged Test Accuracy: 0.5454
-------------Round number: 2-------------
Evaluate global model
[1009.0, 1029.0, 688.0, 645.0, 870.0, 863.0, 936.0, 945.0, 1116.0, 1149.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.3602
Averaged Test Accuracy: 0.6167
------------------------- time cost ------------------------- 21.48362636566162
-------------Round number: 3-------------
Evaluate global model
[1009.0, 1029.0, 688.0, 645.0, 870.0, 863.0, 936.0, 945.0, 1116.0, 1149.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.3602
Averaged Test Accuracy: 0.6167
-------------Round number: 3-------------
Evaluate global model
[1150.0, 1178.0, 772.0, 739.0, 787.0, 783.0, 1066.0, 1070.0, 981.0, 1011.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.3023
Averaged Test Accuracy: 0.6358
------------------------- time cost ------------------------- 20.014100551605225
-------------Round number: 4-------------
Evaluate global model
[1150.0, 1178.0, 772.0, 739.0, 787.0, 783.0, 1066.0, 1070.0, 981.0, 1011.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.3023
Averaged Test Accuracy: 0.6358
-------------Round number: 4-------------
Evaluate global model
[1135.0, 1178.0, 989.0, 978.0, 664.0, 655.0, 1007.0, 1024.0, 1210.0, 1238.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.2666
Averaged Test Accuracy: 0.6719
------------------------- time cost ------------------------- 19.6926748752594
-------------Round number: 5-------------
Evaluate global model
[1135.0, 1178.0, 989.0, 978.0, 664.0, 655.0, 1007.0, 1024.0, 1210.0, 1238.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.2666
Averaged Test Accuracy: 0.6719
-------------Round number: 5-------------
Evaluate global model
[1146.0, 1170.0, 832.0, 797.0, 1063.0, 1067.0, 1126.0, 1140.0, 1261.0, 1287.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.2365
Averaged Test Accuracy: 0.7259
------------------------- time cost ------------------------- 16.40247344970703
-------------Round number: 6-------------
Evaluate global model
[1146.0, 1170.0, 832.0, 797.0, 1063.0, 1067.0, 1126.0, 1140.0, 1261.0, 1287.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.2365
Averaged Test Accuracy: 0.7259
-------------Round number: 6-------------
Evaluate global model
[1163.0, 1174.0, 1059.0, 1027.0, 847.0, 852.0, 1194.0, 1206.0, 1255.0, 1289.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.2140
Averaged Test Accuracy: 0.7377
------------------------- time cost ------------------------- 16.483470678329468
-------------Round number: 7-------------
Evaluate global model
[1163.0, 1174.0, 1059.0, 1027.0, 847.0, 852.0, 1194.0, 1206.0, 1255.0, 1289.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.2140
Averaged Test Accuracy: 0.7377
-------------Round number: 7-------------
Evaluate global model
[1238.0, 1227.0, 1062.0, 1016.0, 903.0, 907.0, 1225.0, 1242.0, 1262.0, 1299.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.1935
Averaged Test Accuracy: 0.7587
------------------------- time cost ------------------------- 16.35531187057495
-------------Round number: 8-------------
Evaluate global model
[1238.0, 1227.0, 1062.0, 1016.0, 903.0, 907.0, 1225.0, 1242.0, 1262.0, 1299.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.1935
Averaged Test Accuracy: 0.7587
-------------Round number: 8-------------
Evaluate global model
[1329.0, 1346.0, 1045.0, 975.0, 1048.0, 1058.0, 1215.0, 1247.0, 1213.0, 1259.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.1734
Averaged Test Accuracy: 0.7823
------------------------- time cost ------------------------- 16.39183473587036
-------------Round number: 9-------------
Evaluate global model
[1329.0, 1346.0, 1045.0, 975.0, 1048.0, 1058.0, 1215.0, 1247.0, 1213.0, 1259.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.1734
Averaged Test Accuracy: 0.7823
-------------Round number: 9-------------
Evaluate global model
[1293.0, 1299.0, 903.0, 845.0, 1258.0, 1260.0, 1225.0, 1279.0, 1269.0, 1295.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.1588
Averaged Test Accuracy: 0.7951
------------------------- time cost ------------------------- 16.343774557113647
-------------Round number: 10-------------
Evaluate global model
[1293.0, 1299.0, 903.0, 845.0, 1258.0, 1260.0, 1225.0, 1279.0, 1269.0, 1295.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.1588
Averaged Test Accuracy: 0.7951
-------------Round number: 10-------------
Evaluate global model
[1415.0, 1405.0, 1100.0, 1069.0, 1054.0, 1062.0, 1220.0, 1257.0, 1246.0, 1264.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 0.1458
Averaged Test Accuracy: 0.8061
------------------------- time cost ------------------------- 14.621236562728882
Best accuracy.
0.8061333333333334
Average time cost per round.
17.890362882614134
File path: ../results/Cifar10_FedCentral_nc=10_jr=1.0_90002.h5
Average time cost: 209.07s.
All done!
Storage on cuda:0
-------------------------------------------------------------------------------
Total Tensors: 29870292 	Used Memory: 77.11M
The allocated memory on cuda:0: 77.11M
-------------------------------------------------------------------------------
Storage on cpu
-------------------------------------------------------------------------------
Total Tensors: 737520000 	Used Memory: 1.37G
-------------------------------------------------------------------------------