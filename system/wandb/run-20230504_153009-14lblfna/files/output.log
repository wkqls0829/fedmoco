
wandb: WARNING Calling wandb.run.save without any arguments is deprecated.Changes to attributes are automatically persisted.
==================================================
Algorithm: FedMGDA
Local batch size: 10
Local steps: 1
Local learing rate: 0.005
Total number of clients: 1
Clients join in each round: 1.0
Client drop rate: 0.0
Time select: False
Time threthold: 10000
Global rounds: 10
Running times: 1
Dataset: Cifar10
Local model: cnn
Using device: cuda
Cuda device id: 7
==================================================
============= Running time: 0th =============
Creating server and clients ...
FedAvgCNN(
  (conv1): Sequential(
    (0): Conv2d(3, 32, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (conv2): Sequential(
    (0): Conv2d(32, 64, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (fc1): Sequential(
    (0): Linear(in_features=1600, out_features=512, bias=True)
    (1): ReLU(inplace=True)
  )
  (fc): Linear(in_features=512, out_features=10, bias=True)
)
Cifar10_central
Cifar10_central
Join ratio / total clients: 1.0 / 1
Finished creating server and clients.
-------------Round number: 0-------------
Evaluate global model
[6881.0]
[15000]
Averaged Train Loss: 1.7895
Averaged Test Accuracy: 0.4587
------------------------- time cost ------------------------- 8.918959140777588
-------------Round number: 1-------------
Evaluate global model
[7733.0]
[15000]
Averaged Train Loss: 1.3933
Averaged Test Accuracy: 0.5155
------------------------- time cost ------------------------- 7.81443190574646
-------------Round number: 2-------------
Evaluate global model
[8864.0]
[15000]
Averaged Train Loss: 1.2155
Averaged Test Accuracy: 0.5909
------------------------- time cost ------------------------- 8.135442972183228
-------------Round number: 3-------------
Evaluate global model
[9332.0]
[15000]
Averaged Train Loss: 1.0715
Averaged Test Accuracy: 0.6221
------------------------- time cost ------------------------- 8.3772873878479
-------------Round number: 4-------------
Evaluate global model
[9855.0]
[15000]
Averaged Train Loss: 0.9655
Averaged Test Accuracy: 0.6570
------------------------- time cost ------------------------- 8.024309396743774
-------------Round number: 5-------------
Evaluate global model
[10167.0]
[15000]
Averaged Train Loss: 0.8769
Averaged Test Accuracy: 0.6778
------------------------- time cost ------------------------- 8.072480916976929
-------------Round number: 6-------------
Evaluate global model
[10272.0]
[15000]
Averaged Train Loss: 0.7950
Averaged Test Accuracy: 0.6848
------------------------- time cost ------------------------- 8.254474401473999
-------------Round number: 7-------------
Evaluate global model
[10487.0]
[15000]
Averaged Train Loss: 0.7203
Averaged Test Accuracy: 0.6991
------------------------- time cost ------------------------- 7.896346092224121
-------------Round number: 8-------------
Evaluate global model
[10663.0]
[15000]
Averaged Train Loss: 0.6503
Averaged Test Accuracy: 0.7109
------------------------- time cost ------------------------- 8.509799718856812
-------------Round number: 9-------------
Evaluate global model
[10651.0]
[15000]
Averaged Train Loss: 0.5831
Averaged Test Accuracy: 0.7101
------------------------- time cost ------------------------- 9.850109577178955
-------------Round number: 10-------------
Evaluate global model
[10923.0]
[15000]
Averaged Train Loss: 0.5159
Averaged Test Accuracy: 0.7282
------------------------- time cost ------------------------- 13.163518190383911
Best accuracy.
0.7282
Average time cost per round.
8.809820055961609
File path: ../results/Cifar10_FedMGDA_nc=1_jr=1.0_90001.h5
Average time cost: 103.51s.
All done!
Storage on cuda:0
-------------------------------------------------------------------------------
Total Tensors: 4392690 	Used Memory: 13.41M
The allocated memory on cuda:0: 13.41M
-------------------------------------------------------------------------------
Storage on cpu
-------------------------------------------------------------------------------
Total Tensors: 368760000 	Used Memory: 703.58M
-------------------------------------------------------------------------------