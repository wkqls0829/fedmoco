
wandb: WARNING Calling wandb.run.save without any arguments is deprecated.Changes to attributes are automatically persisted.
==================================================
Algorithm: FedMGDA
Local batch size: 10
Local steps: 1
Local learing rate: 0.005
Total number of clients: 1
Clients join in each round: 1.0
Client drop rate: 0.0
Time select: False
Time threthold: 10000
Global rounds: 20
Running times: 1
Dataset: Cifar10
Local model: cnn
Using device: cuda
Cuda device id: 7
==================================================
============= Running time: 0th =============
Creating server and clients ...
FedAvgCNN(
  (conv1): Sequential(
    (0): Conv2d(3, 32, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (conv2): Sequential(
    (0): Conv2d(32, 64, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (fc1): Sequential(
    (0): Linear(in_features=1600, out_features=512, bias=True)
    (1): ReLU(inplace=True)
  )
  (fc): Linear(in_features=512, out_features=10, bias=True)
)
Cifar10_central
Cifar10_central
Join ratio / total clients: 1.0 / 1
Finished creating server and clients.
-------------Round number: 0-------------
Evaluate global model
[6863.0]
[15000]
Averaged Train Loss: 1.7894
Averaged Test Accuracy: 0.4575
------------------------- time cost ------------------------- 20.08549213409424
-------------Round number: 1-------------
Evaluate global model
[7714.0]
[15000]
Averaged Train Loss: 1.3930
Averaged Test Accuracy: 0.5143
------------------------- time cost ------------------------- 19.070871353149414
-------------Round number: 2-------------
Evaluate global model
[8888.0]
[15000]
Averaged Train Loss: 1.2146
Averaged Test Accuracy: 0.5925
------------------------- time cost ------------------------- 19.467001914978027
-------------Round number: 3-------------
Evaluate global model
[9330.0]
[15000]
Averaged Train Loss: 1.0710
Averaged Test Accuracy: 0.6220
------------------------- time cost ------------------------- 17.135024070739746
-------------Round number: 4-------------
Evaluate global model
[9871.0]
[15000]
Averaged Train Loss: 0.9652
Averaged Test Accuracy: 0.6581
------------------------- time cost ------------------------- 15.543517112731934
-------------Round number: 5-------------
Evaluate global model
[10171.0]
[15000]
Averaged Train Loss: 0.8765
Averaged Test Accuracy: 0.6781
------------------------- time cost ------------------------- 15.900449514389038
-------------Round number: 6-------------
Evaluate global model
[10339.0]
[15000]
Averaged Train Loss: 0.7951
Averaged Test Accuracy: 0.6893
------------------------- time cost ------------------------- 16.131391525268555
-------------Round number: 7-------------
Evaluate global model
[10489.0]
[15000]
Averaged Train Loss: 0.7204
Averaged Test Accuracy: 0.6993
------------------------- time cost ------------------------- 15.517160177230835
-------------Round number: 8-------------
Evaluate global model
[10681.0]
[15000]
Averaged Train Loss: 0.6506
Averaged Test Accuracy: 0.7121
------------------------- time cost ------------------------- 15.80886960029602
-------------Round number: 9-------------
Evaluate global model
[10612.0]
[15000]
Averaged Train Loss: 0.5836
Averaged Test Accuracy: 0.7075
------------------------- time cost ------------------------- 14.93160605430603
-------------Round number: 10-------------
Evaluate global model
[10863.0]
[15000]
Averaged Train Loss: 0.5177
Averaged Test Accuracy: 0.7242
------------------------- time cost ------------------------- 16.409709453582764
-------------Round number: 11-------------
Evaluate global model
[10867.0]
[15000]
Averaged Train Loss: 0.4495
Averaged Test Accuracy: 0.7245
------------------------- time cost ------------------------- 15.335851192474365
-------------Round number: 12-------------
Evaluate global model
[10965.0]
[15000]
Averaged Train Loss: 0.3870
Averaged Test Accuracy: 0.7310
------------------------- time cost ------------------------- 16.091304540634155
-------------Round number: 13-------------
Evaluate global model
[10760.0]
[15000]
Averaged Train Loss: 0.3235
Averaged Test Accuracy: 0.7173
------------------------- time cost ------------------------- 15.644925594329834
-------------Round number: 14-------------
Evaluate global model
[10761.0]
[15000]
Averaged Train Loss: 0.2637
Averaged Test Accuracy: 0.7174
------------------------- time cost ------------------------- 15.176331043243408
-------------Round number: 15-------------
Evaluate global model
[10934.0]
[15000]
Averaged Train Loss: 0.2092
Averaged Test Accuracy: 0.7289
------------------------- time cost ------------------------- 16.605758666992188
-------------Round number: 16-------------
Evaluate global model
[10788.0]
[15000]
Averaged Train Loss: 0.1600
Averaged Test Accuracy: 0.7192
------------------------- time cost ------------------------- 14.618220567703247
-------------Round number: 17-------------
Evaluate global model
[10903.0]
[15000]
Averaged Train Loss: 0.1221
Averaged Test Accuracy: 0.7269
------------------------- time cost ------------------------- 16.179054260253906
-------------Round number: 18-------------
Evaluate global model
[10936.0]
[15000]
Averaged Train Loss: 0.0828
Averaged Test Accuracy: 0.7291
------------------------- time cost ------------------------- 15.758323669433594
-------------Round number: 19-------------
Evaluate global model
[10959.0]
[15000]
Averaged Train Loss: 0.0551
Averaged Test Accuracy: 0.7306
------------------------- time cost ------------------------- 13.63619589805603
-------------Round number: 20-------------
Evaluate global model
[11000.0]
[15000]
Averaged Train Loss: 0.0333
Averaged Test Accuracy: 0.7333
------------------------- time cost ------------------------- 9.866034984588623
Best accuracy.
0.7333333333333333
Average time cost per round.
15.741380059719086
File path: ../results/Cifar10_FedMGDA_nc=1_jr=1.0_90001.h5
Average time cost: 341.06s.
All done!
Storage on cuda:0
-------------------------------------------------------------------------------
Total Tensors: 4392690 	Used Memory: 13.41M
The allocated memory on cuda:0: 13.41M
-------------------------------------------------------------------------------
Storage on cpu
-------------------------------------------------------------------------------
Total Tensors: 368760000 	Used Memory: 703.58M
-------------------------------------------------------------------------------