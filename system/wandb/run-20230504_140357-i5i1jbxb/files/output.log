
wandb: WARNING Calling wandb.run.save without any arguments is deprecated.Changes to attributes are automatically persisted.
==================================================
Algorithm: FedCentral
Local batch size: 10
Local steps: 1
Local learing rate: 0.005
Total number of clients: 1
Clients join in each round: 1.0
Client drop rate: 0.0
Time select: False
Time threthold: 10000
Global rounds: 20
Running times: 1
Dataset: Cifar10
Local model: cnn
Using device: cuda
Cuda device id: 7
==================================================
============= Running time: 0th =============
Creating server and clients ...
FedAvgCNN(
  (conv1): Sequential(
    (0): Conv2d(3, 32, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (conv2): Sequential(
    (0): Conv2d(32, 64, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (fc1): Sequential(
    (0): Linear(in_features=1600, out_features=512, bias=True)
    (1): ReLU(inplace=True)
  )
  (fc): Linear(in_features=512, out_features=10, bias=True)
)
Cifar10_central
Cifar10_central
Join ratio / total clients: 1.0 / 1
Finished creating server and clients.
Cifar10_central
1
-------------Round number: 0-------------
Evaluate global model
[6866.0]
[15000]
Averaged Train Loss: 1.7898
Averaged Test Accuracy: 0.4577
------------------------- time cost ------------------------- 20.032535791397095
-------------Round number: 1-------------
Evaluate global model
[8100.0]
[15000]
Averaged Train Loss: 1.3919
Averaged Test Accuracy: 0.5400
------------------------- time cost ------------------------- 19.209421634674072
-------------Round number: 2-------------
Evaluate global model
[8918.0]
[15000]
Averaged Train Loss: 1.2099
Averaged Test Accuracy: 0.5945
------------------------- time cost ------------------------- 18.31189227104187
-------------Round number: 3-------------
Evaluate global model
[9455.0]
[15000]
Averaged Train Loss: 1.0699
Averaged Test Accuracy: 0.6303
------------------------- time cost ------------------------- 18.197751760482788
-------------Round number: 4-------------
Evaluate global model
[9780.0]
[15000]
Averaged Train Loss: 0.9642
Averaged Test Accuracy: 0.6520
------------------------- time cost ------------------------- 17.934709072113037
-------------Round number: 5-------------
Evaluate global model
[10169.0]
[15000]
Averaged Train Loss: 0.8731
Averaged Test Accuracy: 0.6779
------------------------- time cost ------------------------- 17.502084970474243
-------------Round number: 6-------------
Evaluate global model
[10592.0]
[15000]
Averaged Train Loss: 0.7933
Averaged Test Accuracy: 0.7061
------------------------- time cost ------------------------- 17.692138671875
-------------Round number: 7-------------
Evaluate global model
[10557.0]
[15000]
Averaged Train Loss: 0.7166
Averaged Test Accuracy: 0.7038
------------------------- time cost ------------------------- 17.73546051979065
-------------Round number: 8-------------
Evaluate global model
[10700.0]
[15000]
Averaged Train Loss: 0.6467
Averaged Test Accuracy: 0.7133
------------------------- time cost ------------------------- 17.54779314994812
-------------Round number: 9-------------
Evaluate global model
[10738.0]
[15000]
Averaged Train Loss: 0.5784
Averaged Test Accuracy: 0.7159
------------------------- time cost ------------------------- 17.71524405479431
-------------Round number: 10-------------
Evaluate global model
[10805.0]
[15000]
Averaged Train Loss: 0.5123
Averaged Test Accuracy: 0.7203
------------------------- time cost ------------------------- 17.862284898757935
-------------Round number: 11-------------
Evaluate global model
[10745.0]
[15000]
Averaged Train Loss: 0.4471
Averaged Test Accuracy: 0.7163
------------------------- time cost ------------------------- 15.014137983322144
-------------Round number: 12-------------
Evaluate global model
[10888.0]
[15000]
Averaged Train Loss: 0.3828
Averaged Test Accuracy: 0.7259
------------------------- time cost ------------------------- 14.776107549667358
-------------Round number: 13-------------
Evaluate global model
[10898.0]
[15000]
Averaged Train Loss: 0.3199
Averaged Test Accuracy: 0.7265
------------------------- time cost ------------------------- 14.690415382385254
-------------Round number: 14-------------
Evaluate global model
[10891.0]
[15000]
Averaged Train Loss: 0.2596
Averaged Test Accuracy: 0.7261
------------------------- time cost ------------------------- 14.818068504333496
-------------Round number: 15-------------
Evaluate global model
[10892.0]
[15000]
Averaged Train Loss: 0.2028
Averaged Test Accuracy: 0.7261
------------------------- time cost ------------------------- 15.012155532836914
-------------Round number: 16-------------
Evaluate global model
[10911.0]
[15000]
Averaged Train Loss: 0.1572
Averaged Test Accuracy: 0.7274
------------------------- time cost ------------------------- 14.894902467727661
-------------Round number: 17-------------
Evaluate global model
[10938.0]
[15000]
Averaged Train Loss: 0.1177
Averaged Test Accuracy: 0.7292
------------------------- time cost ------------------------- 14.922374725341797
-------------Round number: 18-------------
Evaluate global model
[10836.0]
[15000]
Averaged Train Loss: 0.0845
Averaged Test Accuracy: 0.7224
------------------------- time cost ------------------------- 15.301138401031494
-------------Round number: 19-------------
Evaluate global model
[10829.0]
[15000]
Averaged Train Loss: 0.0573
Averaged Test Accuracy: 0.7219
------------------------- time cost ------------------------- 14.914463520050049
-------------Round number: 20-------------
Evaluate global model
[11015.0]
[15000]
Averaged Train Loss: 0.0324
Averaged Test Accuracy: 0.7343
------------------------- time cost ------------------------- 13.183768033981323
Best accuracy.
0.7343333333333333
Average time cost per round.
16.361815655231474
File path: ../results/Cifar10_FedCentral_nc=1_jr=1.0_90003.h5
Average time cost: 356.07s.
All done!
Storage on cuda:0
-------------------------------------------------------------------------------
Total Tensors: 7028304 	Used Memory: 20.12M
The allocated memory on cuda:0: 20.12M
-------------------------------------------------------------------------------
Storage on cpu
-------------------------------------------------------------------------------
Total Tensors: 737520000 	Used Memory: 1.37G
-------------------------------------------------------------------------------