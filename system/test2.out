wandb: Currently logged in as: jabin. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.15.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.1
wandb: Run data is saved locally in /home/kjb/moofl/fedmoco/system/wandb/run-20230509_114809-6impf22j
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run soft-sunset-66
wandb: ‚≠êÔ∏è View project at https://wandb.ai/jabin/fedmoco-system
wandb: üöÄ View run at https://wandb.ai/jabin/fedmoco-system/runs/6impf22j
wandb: WARNING Calling wandb.run.save without any arguments is deprecated.Changes to attributes are automatically persisted.
==================================================
Algorithm: FedSGD
Local batch size: 1500
Local steps: 1
Local learing rate: 0.005
Total number of clients: 10
Clients join in each round: 1.0
Client drop rate: 0.0
Time select: False
Time threthold: 10000
Global rounds: 10
Running times: 1
Dataset: Cifar10
Local model: cnn
Using device: cuda
Cuda device id: 6
==================================================

============= Running time: 0th =============
Creating server and clients ...
FedAvgCNN(
  (conv1): Sequential(
    (0): Conv2d(3, 32, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (conv2): Sequential(
    (0): Conv2d(32, 64, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (fc1): Sequential(
    (0): Linear(in_features=1600, out_features=512, bias=True)
    (1): ReLU(inplace=True)
  )
  (fc): Linear(in_features=512, out_features=10, bias=True)
)
None
None
None
None
None
None
None
None
None
None
None
None
None
None
None
None
None
None
None
None

Join ratio / total clients: 1.0 / 10
Finished creating server and clients.

-------------Round number: 0-------------

Evaluate global model
[0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 477.0, 501.0, 263.0, 253.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 2.3043
Averaged Test Accuracy: 0.0997
------------------------- time cost ------------------------- 1.705686330795288

-------------Round number: 1-------------

Evaluate global model
[0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 472.0, 487.0, 302.0, 303.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 2.3031
Averaged Test Accuracy: 0.1043
------------------------- time cost ------------------------- 0.25977444648742676

-------------Round number: 2-------------

Evaluate global model
[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 475.0, 486.0, 326.0, 315.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 2.3022
Averaged Test Accuracy: 0.1068
------------------------- time cost ------------------------- 0.25330138206481934
new batch
new batch
new batch
new batch
new batch
new batch
new batch
new batch
new batch
new batch

-------------Round number: 3-------------

Evaluate global model
[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 471.0, 479.0, 360.0, 345.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 2.3019
Averaged Test Accuracy: 0.1103
------------------------- time cost ------------------------- 0.25393056869506836

-------------Round number: 4-------------

Evaluate global model
[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 461.0, 460.0, 389.0, 375.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 2.3010
Averaged Test Accuracy: 0.1123
------------------------- time cost ------------------------- 0.2514994144439697

-------------Round number: 5-------------

Evaluate global model
[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 448.0, 437.0, 432.0, 416.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 2.3001
Averaged Test Accuracy: 0.1155
------------------------- time cost ------------------------- 0.24744009971618652
new batch
new batch
new batch
new batch
new batch
new batch
new batch
new batch
new batch
new batch

-------------Round number: 6-------------

Evaluate global model
[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 448.0, 431.0, 458.0, 439.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 2.2996
Averaged Test Accuracy: 0.1184
------------------------- time cost ------------------------- 0.25670289993286133

-------------Round number: 7-------------

Evaluate global model
[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 450.0, 425.0, 472.0, 453.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 2.2986
Averaged Test Accuracy: 0.1200
------------------------- time cost ------------------------- 0.24952149391174316

-------------Round number: 8-------------

Evaluate global model
[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 408.0, 395.0, 524.0, 506.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 2.2981
Averaged Test Accuracy: 0.1222
------------------------- time cost ------------------------- 0.26244020462036133
new batch
new batch
new batch
new batch
new batch
new batch
new batch
new batch
new batch
new batch

-------------Round number: 9-------------

Evaluate global model
[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 396.0, 377.0, 564.0, 534.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 2.2973
Averaged Test Accuracy: 0.1247
------------------------- time cost ------------------------- 0.262040376663208

-------------Round number: 10-------------

Evaluate global model
[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 381.0, 359.0, 598.0, 573.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 2.2963
Averaged Test Accuracy: 0.1274
------------------------- time cost ------------------------- 0.26046013832092285

Best accuracy.
0.1274

Average time cost per round.
0.25571110248565676
File path: ../results/Cifar10_FedSGD_nc=10_jr=1.0_90002.h5

Average time cost: 10.38s.
All done!

Storage on cuda:0
-------------------------------------------------------------------------------
Total Tensors: 12299532 	Used Memory: 43.58M
The allocated memory on cuda:0: 43.58M
-------------------------------------------------------------------------------

Storage on cpu
-------------------------------------------------------------------------------
Total Tensors: 368760000 	Used Memory: 703.59M
-------------------------------------------------------------------------------
wandb: Waiting for W&B process to finish... (success).
wandb: - 0.007 MB of 0.007 MB uploaded (0.000 MB deduped)wandb: \ 0.007 MB of 0.017 MB uploaded (0.000 MB deduped)wandb: | 0.007 MB of 0.019 MB uploaded (0.000 MB deduped)wandb: / 0.019 MB of 0.019 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb: avg_train_loss ‚ñà‚ñá‚ñÜ‚ñÜ‚ñÖ‚ñÑ‚ñÑ‚ñÉ‚ñÉ‚ñÇ‚ñÅ
wandb:       test_acc ‚ñÅ‚ñÇ‚ñÉ‚ñÑ‚ñÑ‚ñÖ‚ñÜ‚ñÜ‚ñá‚ñá‚ñà
wandb: 
wandb: Run summary:
wandb: avg_train_loss 2.2963
wandb:       test_acc 0.1274
wandb: 
wandb: üöÄ View run soft-sunset-66 at: https://wandb.ai/jabin/fedmoco-system/runs/6impf22j
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20230509_114809-6impf22j/logs
