==================================================
Algorithm: FedCentral
Local batch size: 10
Local steps: 1
Local learing rate: 0.005
Total number of clients: 1
Clients join in each round: 1.0
Client drop rate: 0.0
Time select: False
Time threthold: 10000
Global rounds: 20
Running times: 1
Dataset: Cifar10
Local model: cnn
Using device: cuda
Cuda device id: 7
==================================================

============= Running time: 0th =============
Creating server and clients ...
FedAvgCNN(
  (conv1): Sequential(
    (0): Conv2d(3, 32, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (conv2): Sequential(
    (0): Conv2d(32, 64, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (fc1): Sequential(
    (0): Linear(in_features=1600, out_features=512, bias=True)
    (1): ReLU(inplace=True)
  )
  (fc): Linear(in_features=512, out_features=10, bias=True)
)
Cifar10_central

Join ratio / total clients: 1.0 / 1
Finished creating server and clients.
Cifar10_central
1

-------------Round number: 0-------------

Evaluate global model
Cifar10_central
Averaged Train Loss: 2.3039
Averaged Test Accuracy: 0.0942
Averaged Test AUC: 0.4906
Std Test Accuracy: 0.0000
Std Test AUC: 0.0000
Cifar10_central
------------------------- time cost ------------------------- 33.675384283065796

-------------Round number: 1-------------

Evaluate global model
Cifar10_central
Averaged Train Loss: 1.4621
Averaged Test Accuracy: 0.4699
Averaged Test AUC: 0.8503
Std Test Accuracy: 0.0000
Std Test AUC: 0.0000
Cifar10_central
------------------------- time cost ------------------------- 27.406076192855835

-------------Round number: 2-------------

Evaluate global model
Cifar10_central
Averaged Train Loss: 1.3031
Averaged Test Accuracy: 0.5287
Averaged Test AUC: 0.8708
Std Test Accuracy: 0.0000
Std Test AUC: 0.0000
Cifar10_central
------------------------- time cost ------------------------- 23.271278858184814

-------------Round number: 3-------------

Evaluate global model
Cifar10_central
Averaged Train Loss: 1.1740
Averaged Test Accuracy: 0.5646
Averaged Test AUC: 0.8862
Std Test Accuracy: 0.0000
Std Test AUC: 0.0000
Cifar10_central
------------------------- time cost ------------------------- 22.450109004974365

-------------Round number: 4-------------

Evaluate global model
Cifar10_central
Averaged Train Loss: 0.9794
Averaged Test Accuracy: 0.6310
Averaged Test AUC: 0.9106
Std Test Accuracy: 0.0000
Std Test AUC: 0.0000
Cifar10_central
------------------------- time cost ------------------------- 22.749966621398926

-------------Round number: 5-------------

Evaluate global model
Cifar10_central
Averaged Train Loss: 0.8987
Averaged Test Accuracy: 0.6543
Averaged Test AUC: 0.9180
Std Test Accuracy: 0.0000
Std Test AUC: 0.0000
Cifar10_central
------------------------- time cost ------------------------- 22.15043878555298

-------------Round number: 6-------------

Evaluate global model
Cifar10_central
Averaged Train Loss: 0.7908
Averaged Test Accuracy: 0.6817
Averaged Test AUC: 0.9250
Std Test Accuracy: 0.0000
Std Test AUC: 0.0000
Cifar10_central
------------------------- time cost ------------------------- 23.35518479347229

-------------Round number: 7-------------

Evaluate global model
Cifar10_central
Averaged Train Loss: 0.7069
Averaged Test Accuracy: 0.6955
Averaged Test AUC: 0.9290
Std Test Accuracy: 0.0000
Std Test AUC: 0.0000
Cifar10_central
------------------------- time cost ------------------------- 22.657846212387085

-------------Round number: 8-------------

Evaluate global model
Cifar10_central
Averaged Train Loss: 0.6568
Averaged Test Accuracy: 0.7007
Averaged Test AUC: 0.9305
Std Test Accuracy: 0.0000
Std Test AUC: 0.0000
Cifar10_central
------------------------- time cost ------------------------- 23.198188543319702

-------------Round number: 9-------------

Evaluate global model
Cifar10_central
Averaged Train Loss: 0.5514
Averaged Test Accuracy: 0.7170
Averaged Test AUC: 0.9355
Std Test Accuracy: 0.0000
Std Test AUC: 0.0000
Cifar10_central
------------------------- time cost ------------------------- 23.366965770721436

-------------Round number: 10-------------

Evaluate global model
Cifar10_central
Averaged Train Loss: 0.5012
Averaged Test Accuracy: 0.7245
Averaged Test AUC: 0.9304
Std Test Accuracy: 0.0000
Std Test AUC: 0.0000
Cifar10_central
------------------------- time cost ------------------------- 24.16076946258545

-------------Round number: 11-------------

Evaluate global model
Cifar10_central
Averaged Train Loss: 0.4399
Averaged Test Accuracy: 0.7193
Averaged Test AUC: 0.9361
Std Test Accuracy: 0.0000
Std Test AUC: 0.0000
Cifar10_central
------------------------- time cost ------------------------- 22.592142581939697

-------------Round number: 12-------------

Evaluate global model
Cifar10_central
Averaged Train Loss: 0.3501
Averaged Test Accuracy: 0.7315
Averaged Test AUC: 0.9374
Std Test Accuracy: 0.0000
Std Test AUC: 0.0000
Cifar10_central
------------------------- time cost ------------------------- 22.5745632648468

-------------Round number: 13-------------

Evaluate global model
Cifar10_central
Averaged Train Loss: 0.3276
Averaged Test Accuracy: 0.7173
Averaged Test AUC: 0.9340
Std Test Accuracy: 0.0000
Std Test AUC: 0.0000
Cifar10_central
------------------------- time cost ------------------------- 23.60807967185974

-------------Round number: 14-------------

Evaluate global model
Cifar10_central
Averaged Train Loss: 0.2396
Averaged Test Accuracy: 0.7281
Averaged Test AUC: 0.9371
Std Test Accuracy: 0.0000
Std Test AUC: 0.0000
Cifar10_central
------------------------- time cost ------------------------- 21.565908908843994

-------------Round number: 15-------------

Evaluate global model
Cifar10_central
Averaged Train Loss: 0.1937
Averaged Test Accuracy: 0.7258
Averaged Test AUC: 0.9352
Std Test Accuracy: 0.0000
Std Test AUC: 0.0000
Cifar10_central
------------------------- time cost ------------------------- 19.952858209609985

-------------Round number: 16-------------

Evaluate global model
Cifar10_central
Averaged Train Loss: 0.1754
Averaged Test Accuracy: 0.7184
Averaged Test AUC: 0.9365
Std Test Accuracy: 0.0000
Std Test AUC: 0.0000
Cifar10_central
------------------------- time cost ------------------------- 19.60093593597412

-------------Round number: 17-------------

Evaluate global model
Cifar10_central
Averaged Train Loss: 0.1191
Averaged Test Accuracy: 0.7283
Averaged Test AUC: 0.9360
Std Test Accuracy: 0.0000
Std Test AUC: 0.0000
Cifar10_central
------------------------- time cost ------------------------- 20.161269903182983

-------------Round number: 18-------------

Evaluate global model
Cifar10_central
Averaged Train Loss: 0.0708
Averaged Test Accuracy: 0.7345
Averaged Test AUC: 0.9385
Std Test Accuracy: 0.0000
Std Test AUC: 0.0000
Cifar10_central
------------------------- time cost ------------------------- 20.16551375389099

-------------Round number: 19-------------

Evaluate global model
Cifar10_central
Averaged Train Loss: 0.0737
Averaged Test Accuracy: 0.7232
Averaged Test AUC: 0.9347
Std Test Accuracy: 0.0000
Std Test AUC: 0.0000
Cifar10_central
------------------------- time cost ------------------------- 19.948156595230103

-------------Round number: 20-------------

Evaluate global model
Cifar10_central
Averaged Train Loss: 0.0469
Averaged Test Accuracy: 0.7282
Averaged Test AUC: 0.9363
Std Test Accuracy: 0.0000
Std Test AUC: 0.0000
Cifar10_central
------------------------- time cost ------------------------- 17.259501934051514

Best accuracy.
0.7344666666666667

Average time cost per round.
22.10978775024414
File path: ../results/Cifar10_FedCentral_nc=1_jr=1.0_90002.h5

Average time cost: 481.76s.
All done!

Storage on cuda:0
-------------------------------------------------------------------------------
Total Tensors: 6149766 	Used Memory: 16.76M
The allocated memory on cuda:0: 16.76M
-------------------------------------------------------------------------------

Storage on cpu
-------------------------------------------------------------------------------
Total Tensors: 368760000 	Used Memory: 703.58M
-------------------------------------------------------------------------------
