wandb: Currently logged in as: jabin. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.15.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.1
wandb: Run data is saved locally in /home/kjb/moofl/fedmoco/system/wandb/run-20230509_114809-6ia8vhr0
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resilient-firebrand-67
wandb: ‚≠êÔ∏è View project at https://wandb.ai/jabin/fedmoco-system
wandb: üöÄ View run at https://wandb.ai/jabin/fedmoco-system/runs/6ia8vhr0
wandb: WARNING Calling wandb.run.save without any arguments is deprecated.Changes to attributes are automatically persisted.
==================================================
Algorithm: FedSGD
Local batch size: 6000
Local steps: 1
Local learing rate: 0.005
Total number of clients: 10
Clients join in each round: 1.0
Client drop rate: 0.0
Time select: False
Time threthold: 10000
Global rounds: 10
Running times: 1
Dataset: Cifar10
Local model: cnn
Using device: cuda
Cuda device id: 5
==================================================

============= Running time: 0th =============
Creating server and clients ...
FedAvgCNN(
  (conv1): Sequential(
    (0): Conv2d(3, 32, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (conv2): Sequential(
    (0): Conv2d(32, 64, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (fc1): Sequential(
    (0): Linear(in_features=1600, out_features=512, bias=True)
    (1): ReLU(inplace=True)
  )
  (fc): Linear(in_features=512, out_features=10, bias=True)
)
None
None
full batch mode: 4500
None
None
full batch mode: 4500
None
None
full batch mode: 4500
None
None
full batch mode: 4500
None
None
full batch mode: 4500
None
None
full batch mode: 4500
None
None
full batch mode: 4500
None
None
full batch mode: 4500
None
None
full batch mode: 4500
None
None
full batch mode: 4500

Join ratio / total clients: 1.0 / 10
Finished creating server and clients.

-------------Round number: 0-------------

Evaluate global model
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
[0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 487.0, 510.0, 257.0, 247.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 2.3039
Averaged Test Accuracy: 0.1001
------------------------- time cost ------------------------- 2.0100066661834717
new batch
new batch
new batch
new batch
new batch
new batch
new batch
new batch
new batch
new batch

-------------Round number: 1-------------

Evaluate global model
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
[0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 479.0, 499.0, 287.0, 281.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 2.3032
Averaged Test Accuracy: 0.1031
------------------------- time cost ------------------------- 0.5990934371948242
new batch
new batch
new batch
new batch
new batch
new batch
new batch
new batch
new batch
new batch

-------------Round number: 2-------------

Evaluate global model
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 475.0, 485.0, 327.0, 315.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 2.3024
Averaged Test Accuracy: 0.1068
------------------------- time cost ------------------------- 0.6236429214477539
new batch
new batch
new batch
new batch
new batch
new batch
new batch
new batch
new batch
new batch

-------------Round number: 3-------------

Evaluate global model
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 466.0, 472.0, 363.0, 353.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 2.3017
Averaged Test Accuracy: 0.1103
------------------------- time cost ------------------------- 0.6017031669616699
new batch
new batch
new batch
new batch
new batch
new batch
new batch
new batch
new batch
new batch

-------------Round number: 4-------------

Evaluate global model
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 458.0, 456.0, 394.0, 377.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 2.3010
Averaged Test Accuracy: 0.1123
------------------------- time cost ------------------------- 0.6579053401947021
new batch
new batch
new batch
new batch
new batch
new batch
new batch
new batch
new batch
new batch

-------------Round number: 5-------------

Evaluate global model
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 448.0, 434.0, 434.0, 417.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 2.3002
Averaged Test Accuracy: 0.1155
------------------------- time cost ------------------------- 0.5860111713409424
new batch
new batch
new batch
new batch
new batch
new batch
new batch
new batch
new batch
new batch

-------------Round number: 6-------------

Evaluate global model
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 443.0, 421.0, 461.0, 446.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 2.2995
Averaged Test Accuracy: 0.1181
------------------------- time cost ------------------------- 0.5990910530090332
new batch
new batch
new batch
new batch
new batch
new batch
new batch
new batch
new batch
new batch

-------------Round number: 7-------------

Evaluate global model
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 430.0, 406.0, 489.0, 475.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 2.2988
Averaged Test Accuracy: 0.1200
------------------------- time cost ------------------------- 0.5897622108459473
new batch
new batch
new batch
new batch
new batch
new batch
new batch
new batch
new batch
new batch

-------------Round number: 8-------------

Evaluate global model
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 408.0, 396.0, 524.0, 506.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 2.2980
Averaged Test Accuracy: 0.1223
------------------------- time cost ------------------------- 0.5937619209289551
new batch
new batch
new batch
new batch
new batch
new batch
new batch
new batch
new batch
new batch

-------------Round number: 9-------------

Evaluate global model
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 402.0, 381.0, 555.0, 530.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 2.2972
Averaged Test Accuracy: 0.1245
------------------------- time cost ------------------------- 0.615145206451416
new batch
new batch
new batch
new batch
new batch
new batch
new batch
new batch
new batch
new batch

-------------Round number: 10-------------

Evaluate global model
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
test full batch mode: 1500
[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 395.0, 367.0, 584.0, 560.0]
[1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500, 1500]
Averaged Train Loss: 2.2965
Averaged Test Accuracy: 0.1271
------------------------- time cost ------------------------- 0.6171398162841797

Best accuracy.
0.12706666666666666

Average time cost per round.
0.6083256244659424
File path: ../results/Cifar10_FedSGD_nc=10_jr=1.0_90003.h5

Average time cost: 14.22s.
All done!

Storage on cuda:0
-------------------------------------------------------------------------------
Total Tensors: 12299532 	Used Memory: 43.58M
The allocated memory on cuda:0: 44.22M
Memory differs due to the matrix alignment or invisible gradient buffer tensors
-------------------------------------------------------------------------------

Storage on cpu
-------------------------------------------------------------------------------
Total Tensors: 368760000 	Used Memory: 703.59M
-------------------------------------------------------------------------------
wandb: Waiting for W&B process to finish... (success).
wandb: - 0.007 MB of 0.007 MB uploaded (0.000 MB deduped)wandb: \ 0.007 MB of 0.007 MB uploaded (0.000 MB deduped)wandb: | 0.007 MB of 0.007 MB uploaded (0.000 MB deduped)wandb: / 0.007 MB of 0.007 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb: avg_train_loss ‚ñà‚ñá‚ñá‚ñÜ‚ñÖ‚ñÖ‚ñÑ‚ñÉ‚ñÇ‚ñÇ‚ñÅ
wandb:       test_acc ‚ñÅ‚ñÇ‚ñÉ‚ñÑ‚ñÑ‚ñÖ‚ñÜ‚ñÜ‚ñá‚ñá‚ñà
wandb: 
wandb: Run summary:
wandb: avg_train_loss 2.29646
wandb:       test_acc 0.12707
wandb: 
wandb: üöÄ View run resilient-firebrand-67 at: https://wandb.ai/jabin/fedmoco-system/runs/6ia8vhr0
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20230509_114809-6ia8vhr0/logs
