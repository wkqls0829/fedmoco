==================================================
Algorithm: FedMGDA
Local batch size: 10
Local steps: 1
Local learing rate: 0.005
Total number of clients: 20
Clients join in each round: 1.0
Client drop rate: 0.0
Time select: False
Time threthold: 10000
Global rounds: 5
Running times: 1
Dataset: Cifar10
Local model: cnn
Using device: cuda
Cuda device id: 7
==================================================

============= Running time: 0th =============
Creating server and clients ...
FedAvgCNN(
  (conv1): Sequential(
    (0): Conv2d(3, 32, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (conv2): Sequential(
    (0): Conv2d(32, 64, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (fc1): Sequential(
    (0): Linear(in_features=1600, out_features=512, bias=True)
    (1): ReLU(inplace=True)
  )
  (fc): Linear(in_features=512, out_features=10, bias=True)
)

Join ratio / total clients: 1.0 / 20
Finished creating server and clients.

-------------Round number: 0-------------

Evaluate global model
Averaged Train Loss: 2.3040
Averaged Test Accuracy: 0.0953
Averaged Test AUC: 0.4940
Std Test Accuracy: 0.1338
Std Test AUC: 0.1674
[ 6.58990036e-02  2.29093723e-02  6.82062879e-02  9.44560330e-03
  3.14231109e-02  2.94690482e-02  5.55241054e-02  2.56224008e-20
  1.94846413e-02  1.50546306e-01  0.00000000e+00 -1.22170230e-18
  1.23620445e-01  1.39653129e-02 -2.08372161e-18  1.16913606e-01
  1.70820128e-01  1.20539736e-22  5.17290602e-02  7.00439693e-02]
------------------------- time cost ------------------------- 14.146803140640259

-------------Round number: 1-------------

Evaluate global model
Averaged Train Loss: 2.2996
Averaged Test Accuracy: 0.1039
Averaged Test AUC: 0.5227
Std Test Accuracy: 0.2028
Std Test AUC: 0.1774
[0.02107543 0.10237414 0.09313362 0.07413361 0.04626423 0.02407079
 0.0115268  0.06225245 0.01271767 0.         0.04267021 0.01570798
 0.05767669 0.09768904 0.08148077 0.02845776 0.07030404 0.09249305
 0.02685535 0.03911639]
------------------------- time cost ------------------------- 12.840739727020264

-------------Round number: 2-------------

Evaluate global model
Averaged Train Loss: 2.2908
Averaged Test Accuracy: 0.1251
Averaged Test AUC: 0.5541
Std Test Accuracy: 0.1680
Std Test AUC: 0.2192
[0.08281299 0.05532032 0.0225688  0.01957883 0.07974069 0.09331127
 0.06060167 0.07794524 0.07395609 0.07242695 0.06717544 0.0382406
 0.00499859 0.         0.03733031 0.00749512 0.06498968 0.05776221
 0.05106767 0.03267751]
------------------------- time cost ------------------------- 12.829024314880371

-------------Round number: 3-------------

Evaluate global model
Averaged Train Loss: 2.2807
Averaged Test Accuracy: 0.1145
Averaged Test AUC: 0.5552
Std Test Accuracy: 0.2138
Std Test AUC: 0.2705
[2.06017356e-19 8.76669240e-02 6.93466758e-02 5.44842718e-02
 7.45566678e-02 3.52612135e-02 6.33193682e-02 4.09889913e-02
 8.72131241e-03 4.62994689e-03 8.41321649e-02 6.37462610e-02
 5.46938791e-02 6.89219557e-02 6.78969320e-02 9.10352760e-02
 4.20652663e-02 0.00000000e+00 7.36451682e-02 1.48877250e-02]
------------------------- time cost ------------------------- 12.969845056533813

-------------Round number: 4-------------

Evaluate global model
Averaged Train Loss: 2.2735
Averaged Test Accuracy: 0.1111
Averaged Test AUC: 0.5715
Std Test Accuracy: 0.2358
Std Test AUC: 0.2594
[ 5.40321223e-02  8.91121230e-02  1.03363325e-02  5.62133942e-02
  3.53712315e-02  9.73813194e-02  8.38004983e-02  4.82385449e-03
  7.07838105e-02  4.39057487e-02  4.15303762e-02  7.49404188e-02
 -1.41846244e-20  6.87625886e-02  7.34894346e-02  6.79840215e-02
  5.90702724e-02  6.72672800e-02  1.19517296e-03  0.00000000e+00]
------------------------- time cost ------------------------- 12.968521118164062

-------------Round number: 5-------------

Evaluate global model
Averaged Train Loss: 2.2656
Averaged Test Accuracy: 0.1176
Averaged Test AUC: 0.5909
Std Test Accuracy: 0.2395
Std Test AUC: 0.2353
[ 5.26554889e-02  7.26626739e-02  8.13880958e-02  4.33885144e-02
  6.94125349e-03  6.97059028e-03  6.99862206e-02  5.49550290e-02
  7.10677053e-02  4.24083338e-02  1.01414979e-01  3.58348199e-02
  0.00000000e+00  6.37628751e-02  5.58435060e-02  7.82027448e-02
  6.99022350e-02  9.26149347e-02 -6.33911375e-19 -1.31627682e-20]
------------------------- time cost ------------------------- 12.818581104278564

Best accuracy.
0.1251165889407062

Average time cost per round.
12.885342264175415
File path: ../results/Cifar10_FedMGDA_nc=20_jr=1.0_90001.h5

Average time cost: 81.93s.
All done!

Storage on cuda:0
-------------------------------------------------------------------------------
Total Tensors: 54469356 	Used Memory: 140.81M
The allocated memory on cuda:0: 140.81M
-------------------------------------------------------------------------------
