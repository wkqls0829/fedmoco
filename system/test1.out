==================================================
Algorithm: FedMoCo
Local batch size: 10
Local steps: 1
Local learing rate: 0.005
Total number of clients: 20
Clients join in each round: 0.25
Client drop rate: 0.0
Time select: False
Time threthold: 10000
Global rounds: 5
Running times: 1
Dataset: Cifar10
Local model: cnn
Using device: cuda
Cuda device id: 7
==================================================

============= Running time: 0th =============
Creating server and clients ...
FedAvgCNN(
  (conv1): Sequential(
    (0): Conv2d(3, 32, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (conv2): Sequential(
    (0): Conv2d(32, 64, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (fc1): Sequential(
    (0): Linear(in_features=1600, out_features=512, bias=True)
    (1): ReLU(inplace=True)
  )
  (fc): Linear(in_features=512, out_features=10, bias=True)
)

Join ratio / total clients: 0.25 / 20
Finished creating server and clients.

-------------Round number: 0-------------

Evaluate global model
Averaged Train Loss: 2.3040
Averaged Test Accuracy: 0.0974
Averaged Test AUC: 0.4929
Std Test Accuracy: 0.0368
Std Test AUC: 0.0402
------------------------- time cost ------------------------- 10.868841409683228

-------------Round number: 1-------------

Evaluate global model
Averaged Train Loss: 2.3040
Averaged Test Accuracy: 0.0974
Averaged Test AUC: 0.4929
Std Test Accuracy: 0.0368
Std Test AUC: 0.0402
------------------------- time cost ------------------------- 5.935099363327026

-------------Round number: 2-------------

Evaluate global model
Averaged Train Loss: 2.3040
Averaged Test Accuracy: 0.0974
Averaged Test AUC: 0.4929
Std Test Accuracy: 0.0368
Std Test AUC: 0.0402
------------------------- time cost ------------------------- 5.911853790283203

-------------Round number: 3-------------

Evaluate global model
Averaged Train Loss: 2.3040
Averaged Test Accuracy: 0.0974
Averaged Test AUC: 0.4929
Std Test Accuracy: 0.0368
Std Test AUC: 0.0402
------------------------- time cost ------------------------- 9.02344822883606

-------------Round number: 4-------------

Evaluate global model
Averaged Train Loss: 2.3040
Averaged Test Accuracy: 0.0974
Averaged Test AUC: 0.4929
Std Test Accuracy: 0.0368
Std Test AUC: 0.0402
------------------------- time cost ------------------------- 5.878143548965454

-------------Round number: 5-------------

Evaluate global model
Averaged Train Loss: 2.3040
Averaged Test Accuracy: 0.0974
Averaged Test AUC: 0.4929
Std Test Accuracy: 0.0368
Std Test AUC: 0.0402
------------------------- time cost ------------------------- 5.944451093673706

Best accuracy.
0.09741471215351813

Average time cost per round.
6.53859920501709
File path: ../results/Cifar10_FedMoCo_nc=20_jr=0.25_20021.h5

Average time cost: 46.81s.
Length:  1501
std for best accurancy: 0.0
mean for best accurancy: 0.30773333333333336
All done!

Storage on cuda:0
-------------------------------------------------------------------------------
Total Tensors: 66768888 	Used Memory: 197.80M
The allocated memory on cuda:0: 197.80M
-------------------------------------------------------------------------------
